
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Road to Larissa</title>
  <meta name="author" content="Adam Pearce">

  
  <meta name="description" content="The drawdown of a series is the largest decrease in value between two points. If you were to purchase and sell a stock, the start and end of its &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
<!--   <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
 -->

 
  
  <link rel="canonical" href="http://roadtolarissa.com/blog">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Road to Larissa" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!-- <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
 -->
  

</head>
 
<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Road to Larissa</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:roadtolarissa.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<!-- <ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>
 -->
</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  testing!
  <p>1</p>
  <p>downnn</p>
  <p>downnn</p>
  <p>downnn</p>
  <p>downnn</p>

</div>
<aside class="sidebar">
  
    <section>
  <h1>Adam Pearce</h1>
    <a href='mailto:adam.r.pearce@gmail.com' target='_blank' >
	  	<img src='/images/email.png'  style="margin-bottom: 4px">
    </a>

    <a href='/atom.xml' target='_blank'>
      <img src='/images/rss.png'>
    </a>

    <a href='http://stackoverflow.com/users/1333195/adam-pearce' target='_blank'>
      <img src='/images/stackoverflow.png'>
    </a>

    <a href='https://github.com/1wheel' target='_blank'>
      <img src='/images/gitcat.png' style="height: 32px;">
    </a>

    <a href='https://twitter.com/adamrpearce' target='_blank'>
      <img src='/images/twitter_bird.png'>
    </a>
<!-- 
    <a href='http://www.last.fm/user/uniwheel' target='_blank'>
      <img src='/images/last.fm.png'>
    </a>
 &#8211;>
<!--     <a href='https://www.goodreads.com/user/show/1964465-adam' target='_blank'>
      <img src='/images/github.png'>
    </a>
 &#8211;>
    <a href='http://www.linkedin.com/pub/adam-pearce/65/557/a27' target='_blank'>
      <img src='/images/linkedin.png'>
    </a>
    
</section>
<section>
  <h1>Posts</h1>
    
      <li class="post">
        <a href="/drawdown">Drawdown</a>
      </li>
    
      <li class="post">
        <a href="/215-teeth">215 Teeth / 1008 Beats</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/23/even-fewer-lamdas-with-d3/">Even Fewer Lambdas in D3</a>
      </li>
    
      <li class="post">
        <a href="/population-division">Population Division</a>
      </li>
    
      <li class="post">
        <a href="/synth">Making Music With D3</a>
      </li>
    
      <li class="post">
        <a href="/twisters-post">Twisters</a>
      </li>
    
      <li class="post">
        <a href="/nba_draft">NBA Draft</a>
      </li>
    
      <li class="post">
        <a href="/meteor-map">Meteor Map</a>
      </li>
    
      <li class="post">
        <a href="/film-strips-post">Film Strips</a>
      </li>
    
      <li class="post">
        <a href="/whale-words">Whale Words</a>
      </li>
    
      <li class="post">
        <a href="/unemployment-rates">Unemployment Rates</a>
      </li>
    
      <li class="post">
        <a href="/zoomable-sierpinski-triangle-with-d3-js">Zoomable Sierpinski Triangle With d3.js</a>
      </li>
    
      <li class="post">
        <a href="/interactive-visualization-of-white-house-petition-signatures">White House Petition Signatures</a>
      </li>
    
      <li class="post">
        <a href="/next-project">Next Project</a>
      </li>
    
      <li class="post">
        <a href="/redditgraphs-retrospective">Redditgraphs Retrospective</a>
      </li>
    
      <li class="post">
        <a href="/reddit-comment-visualizer">Reddit Comment Visualizer</a>
      </li>
    
      <li class="post">
        <a href="/yglesias-on-amazons-pe-ratio">Yglesias on Amazon&#8217;s P/E Ratio</a>
      </li>
    
      <li class="post">
        <a href="/speed-issues-with-gokos-online-dominion-implementation">Speed Issues Goko Dominion</a>
      </li>
    
      <li class="post">
        <a href="/connect-4-ai-how-it-works">Connect 4 AI: How It Works</a>
      </li>
    
      <li class="post">
        <a href="/maximin-connect-4-completed">Maximin Connect 4 Completed</a>
      </li>
    
      <li class="post">
        <a href="/first-post">First Post</a>
      </li>
    
</section>


<!--   	
  	
  	
  	  
  	  <h2>2014</h2>
  	
  	<article>
  	  
<h1><a href="/drawdown">Drawdown</a></h1>
<time datetime="2014-08-19T00:00:00-04:00" pubdate><span class='month'>Aug</span> <span class='day'>19</span> <span class='year'>2014</span></time>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/215-teeth">215 Teeth / 1008 Beats</a></h1>
<time datetime="2014-08-05T00:00:00-04:00" pubdate><span class='month'>Aug</span> <span class='day'>05</span> <span class='year'>2014</span></time>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/blog/2014/06/23/even-fewer-lamdas-with-d3/">Even Fewer Lambdas in D3</a></h1>
<time datetime="2014-06-23T00:00:00-04:00" pubdate><span class='month'>Jun</span> <span class='day'>23</span> <span class='year'>2014</span></time>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/population-division">Population Division</a></h1>
<time datetime="2014-03-06T00:00:00-05:00" pubdate><span class='month'>Mar</span> <span class='day'>06</span> <span class='year'>2014</span></time>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/synth">Making Music With D3</a></h1>
<time datetime="2014-01-15T00:00:00-05:00" pubdate><span class='month'>Jan</span> <span class='day'>15</span> <span class='year'>2014</span></time>


  	</article>
  	
  	
  	
  	  
  	  <h2>2013</h2>
  	
  	<article>
  	  
<h1><a href="/twisters-post">Twisters</a></h1>
<time datetime="2013-10-22T00:00:00-04:00" pubdate><span class='month'>Oct</span> <span class='day'>22</span> <span class='year'>2013</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/nba_draft">NBA Draft</a></h1>
<time datetime="2013-06-16T00:00:00-04:00" pubdate><span class='month'>Jun</span> <span class='day'>16</span> <span class='year'>2013</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/meteor-map">Meteor Map</a></h1>
<time datetime="2013-05-19T00:00:00-04:00" pubdate><span class='month'>May</span> <span class='day'>19</span> <span class='year'>2013</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/film-strips-post">Film Strips</a></h1>
<time datetime="2013-05-02T00:00:00-04:00" pubdate><span class='month'>May</span> <span class='day'>02</span> <span class='year'>2013</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/whale-words">Whale Words</a></h1>
<time datetime="2013-01-28T00:00:00-05:00" pubdate><span class='month'>Jan</span> <span class='day'>28</span> <span class='year'>2013</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/unemployment-rates">Unemployment Rates</a></h1>
<time datetime="2013-01-21T00:00:00-05:00" pubdate><span class='month'>Jan</span> <span class='day'>21</span> <span class='year'>2013</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	  
  	  <h2>2012</h2>
  	
  	<article>
  	  
<h1><a href="/zoomable-sierpinski-triangle-with-d3-js">Zoomable Sierpinski Triangle With d3.js</a></h1>
<time datetime="2012-12-21T00:00:00-05:00" pubdate><span class='month'>Dec</span> <span class='day'>21</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/interactive-visualization-of-white-house-petition-signatures">White House Petition Signatures</a></h1>
<time datetime="2012-12-19T00:00:00-05:00" pubdate><span class='month'>Dec</span> <span class='day'>19</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/next-project">Next Project</a></h1>
<time datetime="2012-11-20T00:00:00-05:00" pubdate><span class='month'>Nov</span> <span class='day'>20</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/redditgraphs-retrospective">Redditgraphs Retrospective</a></h1>
<time datetime="2012-11-17T00:00:00-05:00" pubdate><span class='month'>Nov</span> <span class='day'>17</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/reddit-comment-visualizer">Reddit Comment Visualizer</a></h1>
<time datetime="2012-10-19T00:00:00-04:00" pubdate><span class='month'>Oct</span> <span class='day'>19</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/redditgraphs/'>redditgraphs</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/yglesias-on-amazons-pe-ratio">Yglesias on Amazon&#8217;s P/E Ratio</a></h1>
<time datetime="2012-10-10T00:00:00-04:00" pubdate><span class='month'>Oct</span> <span class='day'>10</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/speed-issues-with-gokos-online-dominion-implementation">Speed Issues Goko Dominion</a></h1>
<time datetime="2012-10-06T00:00:00-04:00" pubdate><span class='month'>Oct</span> <span class='day'>06</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/connect-4-ai-how-it-works">Connect 4 AI: How It Works</a></h1>
<time datetime="2012-09-30T00:00:00-04:00" pubdate><span class='month'>Sep</span> <span class='day'>30</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/maximin-connect-4-completed">Maximin Connect 4 Completed</a></h1>
<time datetime="2012-09-29T00:00:00-04:00" pubdate><span class='month'>Sep</span> <span class='day'>29</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
  	
  	
  	<article>
  	  
<h1><a href="/first-post">First Post</a></h1>
<time datetime="2012-09-27T00:00:00-04:00" pubdate><span class='month'>Sep</span> <span class='day'>27</span> <span class='year'>2012</span></time>

<footer>
  <span class="categories">posted in <a class='category' href='/blog/categories/uncategorized/'>Uncategorized</a></span>
</footer>


  	</article>
  	
 &#8211;>
  
</aside>
<!-- <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/drawdown">Drawdown</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-19T00:00:00-04:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><link rel="stylesheet" type="text/css" href="/javascripts/posts/drawDown/style.css"></p>

<p>The <a href="http://en.wikipedia.org/wiki/Drawdown_(economics)">drawdown</a> of a series is the largest decrease in value between two points. If you were to purchase and sell a stock, the start and end of its drawdown would be the worst time to do so.</p>

<p>Since order matters, calculating drawdown isn&rsquo;t as simple as finding the maximum and minimum values of the series &ndash; if the minimum occurs before the maximum, such an approach will identify a period of appreciation. To avoid this case, we can iterate over each index <span class='i-text'><code>i</code></span> of the series, then compare the price at time <span class='i-text'><code>i</code></span> to the price at all subsequent indices <span class='j-text'><code>j</code></span>. <span class='maxDrawdown-text'><code>maxDrawdown</code></span> is equal to the largest difference between prices at <span class='i-text'><code>i</code></span> and <span class='j-text'><code>j</code></span>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">prices</span><span class="p">.</span><span class="nx">length</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">){</span>
</span><span class='line'>        <span class="nx">dif</span> <span class="o">=</span> <span class="nx">prices</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">-</span> <span class="nx">prices</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
</span><span class='line'>        <span class="nx">maxDrawdown</span> <span class="o">=</span> <span class="nx">maxDrawdown</span> <span class="o">&gt;</span> <span class="nx">dif</span> <span class="o">?</span> <span class="nx">maxDrawdown</span> <span class="o">:</span> <span class="nx">dif</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>While accurate, this algorithm require many value comparisons:</p>

<div id='drawDownNaive' style='width: 100%; height: 300px'></div>


<p>If the series has <span class='n-text'><code>n</code></span> prices, <code>n*(n - 1)/2</code> comparisons are needed (the number of comparisons done during the <span class='i-text'><code>i</code></span>th pass through the inner loop is <code>n - i - 1</code>; the <a href="http://en.wikipedia.org/wiki/Triangular_number">sum</a> of all those comparisons is <code>1 + 2 + 3 + ... + n - 1</code>). The number of comparisons increases faster than <code>n</code> &ndash; if there are <code>100</code> values, <code>4950</code> comparisons are needed, while <code>200</code> values requires <code>19900</code> comparisons. For series covering a long period of time or with a great deal of granularity, this algorithm might be too slow even for a fast computer.</p>

<p>Instead of comparing every value with every other value, we can exploit the sequential requirement and make only <code>n - 1</code> comparisons:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">peak</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">prices</span><span class="p">.</span><span class="nx">length</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span><span class='line'>    <span class="nx">dif</span> <span class="o">=</span> <span class="nx">prices</span><span class="p">[</span><span class="nx">peak</span><span class="p">]</span> <span class="o">-</span> <span class="nx">prices</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span class='line'>    <span class="nx">peak</span> <span class="o">=</span> <span class="nx">dif</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">i</span> <span class="o">:</span> <span class="nx">j</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">maxDrawdown</span> <span class="o">=</span> <span class="nx">maxDrawdown</span> <span class="o">&gt;</span> <span class="nx">dif</span> <span class="o">?</span> <span class="nx">maxDrawdown</span> <span class="o">:</span> <span class="nx">dif</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Iterating over each index <span class='i-text'><code>i</code></span> of the series in order, the maximum decline ending at point <span class='i-text'><code>i</code></span> will start at the highest point of the series so far. While passing over the series we keep track of two numbers &ndash; the <span class='peak-text'><code>peak</code></span> of the series and the <span class='maxDrawdown-text'><code>maxDrawdown</code></span> in price between <span class='peak-text'><code>peak</code></span> and <span class='i-text'><code>i</code></span>.</p>

<div id='oN' style='width: 100%; height: 300px'></div>


<p>The speed difference between the two algorithms is proportional to the number of prices. Calculating drawdown with the second approach on a series with <code>100</code> values takes <code>99</code> comparisons instead of <code>4950</code>, which is <code>50</code> (<code>100/2</code>) times faster. A series with <code>200</code> values requires <code>199</code> comparisons instead of <code>19900</code>, which is <code>100</code> (<code>200/2</code>) times faster. In general, since the first approach requires <code>n*(n - 1)/2</code> comparisons for a series with <span class='n-text'><code>n</code></span> values and the second <code>n - 1</code> comparisons, the second approach will be <code>n/2</code> times faster.</p>

<script src="/javascripts/libs/d3.4.11.js" type="text/javascript"></script>


<script src="/javascripts/libs/lodash.js" type="text/javascript"></script>


<script src="/javascripts/posts/negBarTransition/lib.js" type="text/javascript"></script>




<script src="/javascripts/posts/drawDown/scales.js" type="text/javascript"></script>


<script src="/javascripts/posts/drawDown/naive.js" type="text/javascript"></script>


<script src="/javascripts/posts/drawDown/oN.js" type="text/javascript"></script>


<script src="/javascripts/posts/drawDown/stylePost.js" type="text/javascript"></script>


<p><meta property="og:image" content="/images/thumbnails/215-teeth.png" /></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
 &#8211;>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Adam Pearce -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
